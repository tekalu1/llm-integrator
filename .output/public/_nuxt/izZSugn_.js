import{u as x}from"./D-sMymdb.js";import{d as h,r as p,o as _,v as n,x as l,y as a,z as m,L as f,O as y,P as k}from"./JqZd4KxG.js";import"./BcTueDZh.js";import"./IShi1APO.js";import"./DvF23Exx.js";const E=h({__name:"index",setup(O){const i=x(),c=p([]),s=p("connecting");async function w(e,t){const r=new TextDecoder("utf-8");let o="";for(;;){const{done:S,value:v}=await e.read();if(S)break;o+=r.decode(v,{stream:!0});let u=o.split(`
`);o=u.pop()||"";for(const d of u)if(d.trim()){const g=JSON.parse(d);t(g)}}}const b=async()=>{try{const e=await fetch("/api/execute/stream",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({flowItem:i.masterFlow,variables:i.masterFlow.variables})});if(!e.body)throw new Error("No response body");s.value="streaming";const t=e.body.getReader();await w(t,r=>{console.log("Received:",r),c.value.push(r)}),s.value="completed"}catch(e){s.value="error",console.error("Streaming error:",e)}};return _(async()=>{}),(e,t)=>(n(),l(y,null,[a("button",{onClick:b,class:"border rounded-md px-2 py-1"}," start "),a("div",null,[t[0]||(t[0]=a("h1",null,"POST + ReadableStream Example",-1)),a("p",null,"Status: "+m(f(s)),1),a("ul",null,[(n(!0),l(y,null,k(f(c),(r,o)=>(n(),l("li",{key:o},m(r),1))),128))])])],64))}});export{E as default};
